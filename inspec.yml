name: cms-ars-3.1-moderate-crunchy-data-postgresql-9-stig-overlay
title: cms-ars-3.1-moderate-crunchy-data-postgresql-9-stig-overlay
maintainer: CMS InSpec Dev team
copyright: 
copyright_email: 
license: Apache-2.0
summary: "CMS ARS 3.1 Moderate Overlay InSpec Validation Profile for Crunchy Data PostgreSQL 9 STIG"
version: 0.1.1
inspec_version: ">= 4.0"

depends:
- name: pgstigcheck-inspec
  url: https://github.com/CrunchyData/pgstigcheck-inspec/archive/master.tar.gz
  
inputs:
  - name: pg_owner
    description: 'Postgres OS user (e.g., ''postgres'').'
    type: string
    value: ''
    sensitive: true
    profile: pgstigcheck-inspec

  - name: pg_group
    description: 'Postgres OS group (e.g., ''postgres'').'
    type: string
    value: ''
    sensitive: true
    profile: pgstigcheck-inspec

  - name: pg_owner_password
    description: 'Postgres OS user password'
    type: string
    value: ''
    sensitive: true
    profile: pgstigcheck-inspec

  - name: pg_dba
    description: 'Postgres database admin user (e.g., ''root'').'
    type: string
    value: ''
    sensitive: true
    profile: pgstigcheck-inspec

  - name: pg_dba_password
    description: 'Postgres database admin password (''password'').'
    type: string
    value: ''
    sensitive: true
    profile: pgstigcheck-inspec

  - name: pg_user
    description: 'Postgres normal user'
    type: string
    value: ''
    sensitive: true
    profile: pgstigcheck-inspec

  - name: pg_user_password
    description: 'Postgres normal user password'
    type: string
    value: ''
    sensitive: true
    profile: pgstigcheck-inspec

  - name: pg_host
    description: 'Postgres database hostname'
    type: string
    value: ''
    sensitive: true
    profile: pgstigcheck-inspec

  - name: pg_port
    description: 'Postgres database port'
    type: numeric
    value: 5432
    sensitive: true
    profile: pgstigcheck-inspec

  - name: pg_db
    description: 'Postgres database name (''test'')'
    type: string
    value: ''
    sensitive: true
    profile: pgstigcheck-inspec

  - name: pg_table
    description: 'Postgres database table name'
    type: string
    value: ''
    sensitive: true
    profile: pgstigcheck-inspec

  - name: login_user
    description: 'User on remote database server'
    type: string
    value: ''
    sensitive: true
    profile: pgstigcheck-inspec

  - name: login_host
    description: 'Database host ip'
    type: string
    value: ''
    sensitive: true
    profile: pgstigcheck-inspec

  - name: pg_version
    description: 'Database version'
    type: numeric
    value: 9.5
    profile: pgstigcheck-inspec

  - name: pg_data_dir
    description: 'Data directory for database (e.g., ''/var/lib/pgsql/9.5/data'').' 
    type: string
    value: ''
    profile: pgstigcheck-inspec

  - name: pg_conf_file
    description: 'Configuration file for the database (''/var/lib/pgsql/9.5/data/postgresql.conf'').'
    type: string
    value: ''
    profile: pgstigcheck-inspec

  - name: pg_user_defined_conf
    description: 'User defined configuration file for the database (e.g., ''/var/lib/pgsql/9.5/data/stig-postgresql.conf'').'
    type: string
    value: ''
    profile: pgstigcheck-inspec

  - name: pg_hba_conf_file
    description: 'Configuration file to enable client authentication (e.g., ''/var/lib/pgsql/9.5/data/pg_hba.conf'').'
    type: string
    value: ''
    profile: pgstigcheck-inspec

  - name: pg_ident_conf_file
    description: 'Configuration file that maps operating system usernames and database usernames (e.g., ''/var/lib/pgsql/9.5/data/pg_ident.conf'').'
    type: string
    value: ''
    profile: pgstigcheck-inspec

  - name: pg_shared_dirs
    description: 'List of shared directories (e.g., pg_shared_dirs: [''/usr/pgsql-9.5'', ''/usr/pgsql-9.5/bin'', ''/usr/pgsql-9.5/lib'', ''/usr/pgsql-9.5/share'']).'
    type: array
    value: []
    profile: pgstigcheck-inspec

  - name: pg_conf_mode
    description: 'Database configuration mode'
    type: numeric
    value: 0600
    profile: pgstigcheck-inspec

  - name: pg_ssl
    description: 'Postgres ssl setting (e.g., ''on'').'
    type: string
    value: ''
    profile: pgstigcheck-inspec

  - name: pg_log_dest
    description: 'Postgres log destination (e.g., ''syslog'').'
    type: string
    value: ''
    profile: pgstigcheck-inspec

  - name: pg_syslog_facility
    description: 'Postgres syslog facility (e.g., [''local0'']).'
    type: array
    value: []
    profile: pgstigcheck-inspec

  - name: pg_syslog_owner
    description: 'Postgres syslog owner (e.g., ''postgres'').'
    type: string
    value: ''
    profile: pgstigcheck-inspec

  - name: pgaudit_log_items
    description: 'Postgres audit log items (e.g., [''ddl'',''role'',''read'',''write'']).'
    type: array
    value: []
    profile: pgstigcheck-inspec

  - name: pgaudit_log_line_items
    description: 'Postgres audit log line items (e.g. [''%m'',''%u'',''%c'']).'
    type: array
    value: []
    profile: pgstigcheck-inspec

  - name: pg_superusers
    description: 'Postgres super users (e.g., [''postgres'']).'
    type: array
    value: []
    profile: pgstigcheck-inspec

  - name: pg_users
    description: 'Postgres users'
    type: array
    value: []
    profile: pgstigcheck-inspec

  - name: pg_replicas
    description: 'Postgres replicas (e.g. [''192.168.1.3/32'']).'
    type: array
    value: []
    profile: pgstigcheck-inspec

  - name: pg_max_connections
    description: 'Postgres max number of connections allowed (e.g., 100).'
    type: numeric
    value: 0
    profile: pgstigcheck-inspec

  - name: pg_timezone
    description: 'Postgres timezone (e.g., ''UTC'').'
    type: string
    value: ''
    profile: pgstigcheck-inspec

  - name: pg_object_granted_privileges
    description: 'Privileges that can be granted to a role for a database object (e.g., ''arwdDx'').'
    type: string
    value: ''
    profile: pgstigcheck-inspec

  - name: pg_object_public_privileges
    description: 'Privileges that can be granted to public for a database object (e.g., ''r'').'
    type: string
    value: ''
    profile: pgstigcheck-inspec

  - name: pg_object_exceptions
    description: 'List of database objects that should be excepted from tests (e.g., [''pg_settings'']).'
    type: array
    value: []
    profile: pgstigcheck-inspec
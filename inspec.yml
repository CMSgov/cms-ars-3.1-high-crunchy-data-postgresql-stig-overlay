name: cms-ars-3.1-crunchy-data-postgresql-9-stig-overlay
title: .
maintainer: CMS InSpec Dev team
copyright: . 
copyright_email: 
license: Apache-2.0
summary: .
version: 0.1.0

depends:
- name: pgstigcheck-inspec
  path: ../pgstigcheck-inspec
  
attributes:
  - name: pg_owner
    description: 'Postgres OS user (e.g., ''postgres'').'
    type: string
    default: ''

  - name: pg_group
    description: 'Postgres OS group (e.g., ''postgres'').'
    type: string
    default: ''

  - name: pg_owner_password
    description: 'Postgres OS user password'
    type: string
    default: ''

  - name: pg_dba
    description: 'Postgres database admin user (e.g., ''root'').'
    type: string
    default: ''

  - name: pg_dba_password
    description: 'Postgres database admin password (''password'').'
    type: string
    default: ''

  - name: pg_user
    description: 'Postgres normal user'
    type: string
    default: ''

  - name: pg_user_password
    description: 'Postgres normal user password'
    type: string
    default: ''

  - name: pg_host
    description: 'Postgres database hostname'
    type: string
    default: ''

  - name: pg_port
    description: 'Postgres database port'
    type: numeric
    default: 5432

  - name: pg_db
    description: 'Postgres database name (''test'')'
    type: string
    default: ''

  - name: pg_table
    description: 'Postgres database table name'
    type: string
    default: ''

  - name: login_user
    description: 'User on remote database server'
    type: string
    default: ''

  - name: login_host
    description: 'Database host ip'
    type: string
    default: ''

  - name: pg_version
    description: 'Database version'
    type: numeric
    default: 9.5

  - name: pg_data_dir
    description: 'Data directory for database (e.g., ''/var/lib/pgsql/9.5/data'').' 
    type: string
    default: ''

  - name: pg_conf_file
    description: 'Configuration file for the database (''/var/lib/pgsql/9.5/data/postgresql.conf'').'
    type: string
    default: ''

  - name: pg_user_defined_conf
    description: 'User defined configuration file for the database (e.g., ''/var/lib/pgsql/9.5/data/stig-postgresql.conf'').'
    type: string
    default: ''

  - name: pg_hba_conf_file
    description: 'Configuration file to enable client authentication (e.g., ''/var/lib/pgsql/9.5/data/pg_hba.conf'').'
    type: string
    default: ''

  - name: pg_ident_conf_file
    description: 'Configuration file that maps operating system usernames and database usernames (e.g., ''/var/lib/pgsql/9.5/data/pg_ident.conf'').'
    type: string
    default: ''

  - name: pg_shared_dirs
    description: 'List of shared directories (e.g., pg_shared_dirs: [''/usr/pgsql-9.5'', ''/usr/pgsql-9.5/bin'', ''/usr/pgsql-9.5/lib'', ''/usr/pgsql-9.5/share'']).'
    type: array
    default: []

  - name: pg_conf_mode
    description: 'Database configuration mode'
    type: numeric
    default: 0600

  - name: pg_ssl
    description: 'Postgres ssl setting (e.g., ''on'').'
    type: string
    default: ''

  - name: pg_log_dest
    description: 'Postgres log destination (e.g., ''syslog'').'
    type: string
    default: ''

  - name: pg_syslog_facility
    description: 'Postgres syslog facility (e.g., [''local0'']).'
    type: array
    default: []

  - name: pg_syslog_owner
    description: 'Postgres syslog owner (e.g., ''postgres'').'
    type: string
    default: ''

  - name: pgaudit_log_items
    description: 'Postgres audit log items (e.g., [''ddl'',''role'',''read'',''write'']).'
    type: array
    default: []

  - name: pgaudit_log_line_items
    description: 'Postgres audit log line items (e.g. [''%m'',''%u'',''%c'']).'
    type: array
    default: []

  - name: pg_superusers
    description: 'Postgres super users (e.g., [''postgres'']).'
    type: array
    default: []

  - name: pg_users
    description: 'Postgres users'
    type: array
    default: []

  - name: pg_replicas
    description: 'Postgres replicas (e.g. [''192.168.1.3/32'']).'
    type: array
    default: []

  - name: pg_max_connections
    description: 'Postgres max number of connections allowed (e.g., 100).'
    type: numeric
    default: 0

  - name: pg_timezone
    description: 'Postgres timezone (e.g., ''UTC'').'
    type: string
    default: ''

  - name: pg_object_granted_privileges
    description: 'Privileges that can be granted to a role for a database object (e.g., ''arwdDx'').'
    type: string
    default: ''

  - name: pg_object_public_privileges
    description: 'Privileges that can be granted to public for a database object (e.g., ''r'').'
    type: string
    default: ''

  - name: pg_object_exceptions
    description: 'List of database objects that should be excepted from tests (e.g., [''pg_settings'']).'
    type: array
    default: []
